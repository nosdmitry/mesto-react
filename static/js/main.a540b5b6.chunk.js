(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(7),c=a.n(o),i=(a(6),a(10)),s=a(2),l=a.p+"static/media/logo.03b78ada.svg",u=a(0);var p=function(){return Object(u.jsx)("header",{className:"header",children:Object(u.jsx)("a",{href:"./index.html",className:"header__logo-link",target:"_self",children:Object(u.jsx)("img",{src:l,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f",className:"header__logo"})})})},d=r.a.createContext();var _=function(e){var t=e.card,a=e.openImage,n=e.onCardLike,o=e.onDeleteCardClick,c=r.a.useContext(d),i=c._id===t.owner._id,s=t.likes.some((function(e){return e._id===c._id}))?"galery__heart galery__heart_active":"galery__heart";return Object(u.jsxs)("article",{className:"galery__card",children:[Object(u.jsx)("button",{onClick:function(){o(t)},type:"button",className:"galery__delete-card-button galery__delete-card-button".concat(i?"":"_visible_hidden"),"aria-label":"Delete_card"}),Object(u.jsx)("img",{onClick:function(){a(t)},src:t.link,alt:t.name,className:"galery__img"}),Object(u.jsx)("h2",{className:"galery__text",children:t.name}),Object(u.jsxs)("div",{className:"galery__likes-wrap",children:[Object(u.jsx)("button",{onClick:function(){n(t)},type:"button","aria-label":"Like",className:s}),Object(u.jsx)("div",{className:"galery__heart galery__heart_loading galery__heart_visible_hidden"}),Object(u.jsx)("span",{className:"galery__likes-counter",children:t.likes.length})]})]})};var h=function(){return Object(u.jsx)("div",{className:"galery__card galery__card_loading"})};var j=function(e){var t=r.a.useContext(d);return Object(u.jsxs)("main",{children:[Object(u.jsxs)("section",{className:"profile",children:[Object(u.jsx)("button",{onClick:e.onEditAvatar,className:"profile__image profile__image",style:{backgroundImage:"url(".concat(t.avatar,")")},"aria-label":"\u0410\u0432\u0430\u0442\u0430\u0440"}),Object(u.jsxs)("div",{className:"profile__text-wrap",children:[Object(u.jsxs)("div",{className:"profile__title-wrap",children:[Object(u.jsx)("h1",{className:"profile__title","aria-label":"\u0418\u043c\u044f",children:t.name}),Object(u.jsx)("button",{onClick:e.onEditProfile,type:"button","aria-label":"Edit_profile",className:"profile__edit"})]}),Object(u.jsx)("p",{className:"profile__subtitle","aria-label":"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:t.about})]}),Object(u.jsx)("button",{onClick:e.onAddPlace,type:"button","aria-label":"Add_img",className:"profile__add-card-button"})]}),Object(u.jsx)("section",{className:"galery galery_margins","aria-label":"\u0413\u0430\u043b\u0435\u0440\u0435\u044f",children:Object(u.jsx)("div",{className:"galery__cards",children:e.loadingSpinner?Object(u.jsx)(h,{}):e.cards.map((function(t){return Object(u.jsx)(_,{card:t,openImage:e.onCardClick,onCardLike:e.onCardLike,onDeleteCardClick:e.onDeleteCardClick},t._id)}))})})]})};var m=function(){return Object(u.jsx)("footer",{className:"footer",children:Object(u.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var b=function(e){return Object(u.jsx)("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),children:Object(u.jsxs)("div",{className:"popup__container",children:[Object(u.jsx)("button",{onClick:e.onClose,type:"button","aria-label":"Close_popup",className:"popup__exit-button exit exit_button_profile-popup"}),Object(u.jsx)("h3",{className:"popup__form-title",children:e.title}),Object(u.jsxs)("form",{onSubmit:e.onSubmit,name:"popup_form_".concat(e.name),className:"popup__form popup__form_edit_peronal-data",noValidate:!0,children:[e.children,Object(u.jsx)("button",{type:"submit",name:"submit-edit-profile",className:"popup__submit-button",children:e.submitName})]})]})})};var f=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,o=r.a.useContext(d),c=r.a.useState(""),i=Object(s.a)(c,2),l=i[0],p=i[1],_=r.a.useState(""),h=Object(s.a)(_,2),j=h[0],m=h[1];return r.a.useEffect((function(){p(o.name),m(o.about)}),[o]),Object(u.jsxs)(b,{name:"profile-edit-form",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:l,about:j})},children:[Object(u.jsxs)("label",{className:"popup__form-field",children:[Object(u.jsx)("input",{id:"user-name",type:"text",name:"popup_name",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f",className:"popup__input popup__input_type_name",value:l,onChange:function(e){p(e.target.value)},required:!0}),Object(u.jsx)("span",{className:"user-name-error popup__error"})]}),Object(u.jsxs)("label",{className:"popup__form-field",children:[Object(u.jsx)("input",{id:"user-description",type:"text",name:"popup_description",minLength:"2",maxLength:"200",placeholder:"\u0420\u043e\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",className:"popup__input popup__input_type_description",value:j,onChange:function(e){m(e.target.value)},required:!0}),Object(u.jsx)("span",{className:"user-description-error popup__error"})]})]})};var O=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,o=r.a.useRef("");return Object(u.jsx)(b,{name:"change-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitName:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({avatar:o.current.value}),e.target.reset()},children:Object(u.jsxs)("label",{className:"popup__form-field",children:[Object(u.jsx)("input",{id:"user-avatar",type:"url",name:"popup_description",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_image-link",ref:o,required:!0}),Object(u.jsx)("span",{className:"user-avatar-error popup__error"})]})})};var g=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,o=r.a.useState(""),c=Object(s.a)(o,2),i=c[0],l=c[1],p=r.a.useState(""),d=Object(s.a)(p,2),_=d[0],h=d[1];return Object(u.jsxs)(b,{name:"cards-add-form",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitName:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n({name:i,link:_}),l(""),h("")},children:[Object(u.jsxs)("label",{className:"popup__form-field",children:[Object(u.jsx)("input",{id:"place-name",type:"text",name:"popup_name",minLength:"2",maxLength:"30",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__input popup__input_type_card-name",onChange:function(e){l(e.target.value)},value:i||"",required:!0}),Object(u.jsx)("span",{className:"place-name-error popup__error"})]}),Object(u.jsxs)("label",{className:"popup__form-field",children:[Object(u.jsx)("input",{id:"place-url",type:"url",name:"popup_description",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__input popup__input_type_image-link",onChange:function(e){h(e.target.value)},value:_||"",required:!0}),Object(u.jsx)("span",{className:"place-url-error popup__error"})]})]})};var x=function(e){return Object(u.jsx)("div",{className:"popup galery galery_popup ".concat(e.card?"popup_opened":""),children:Object(u.jsxs)("figure",{className:"galery__popup-image-container",children:[Object(u.jsx)("button",{onClick:e.onClose,type:"button","aria-label":"Close_popup",className:"popup__exit-button galery__popup-exit"}),Object(u.jsx)("img",{src:e.card.link,alt:e.card.name,className:"galery__fulsize-img"}),Object(u.jsx)("figcaption",{className:"galery__popup-text",children:e.card.name})]})})};var v=function(e){var t=e.isOpen,a=e.onClose,n=e.onDeleteCard;return Object(u.jsx)(b,{name:"card-delete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitName:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){e.preventDefault(),n()}})},C=a(8),y=a(9),N=new(function(){function e(t){Object(C.a)(this,e),this._url=t.url,this._headers=t.headers,this._body=t.body}return Object(y.a)(e,[{key:"_onError",value:function(e,t){return e.ok?e.json():Promise.reject("".concat(t,": ")+e.status)}},{key:"getUserInfo",value:function(){var e=this;return fetch("".concat(this._url,"users/me"),{headers:this._headers}).then((function(t){return e._onError(t,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u043a \u0441\u0435\u0440\u0432\u0435\u0440\u0443")}))}},{key:"editUserInfo",value:function(e){var t=this;return fetch("".concat(this._url,"users/me"),{method:"PATCH",headers:{authorization:this._headers.authorization,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return t._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f")}))}},{key:"getAllCards",value:function(){var e=this;return fetch("".concat(this._url,"cards/"),{headers:this._headers}).then((function(t){return e._onError(t,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a")}))}},{key:"addNewCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/"),{method:"POST",headers:{authorization:this._headers.authorization,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return t._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043d\u043e\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438")}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._url,"cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u0447\u043e\u043a\u0438")}))}},{key:"handleCardLikeStatus",value:function(e,t){var a=this;console.log("hello from API!");var n=t?"PUT":"DELETE";return fetch("".concat(this._url,"cards/likes/").concat(e),{method:n,headers:this._headers}).then((function(e){return a._onError(e,"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u043b\u0430\u0439\u043a\u0430")}))}},{key:"changeAvatar",value:function(e){var t=this;return fetch("https://mesto.nomoreparties.co/v1/cohort-20/users/me/avatar",{method:"PATCH",headers:{authorization:this._headers.authorization,"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return t._onError(e,"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443")}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-20/",headers:{authorization:"036c4f02-47a4-4c62-a975-bbce507f165f"}});var k=function(){var e=r.a.useState(!1),t=Object(s.a)(e,2),a=t[0],n=t[1],o=r.a.useState(!1),c=Object(s.a)(o,2),l=c[0],_=c[1],h=r.a.useState(!1),b=Object(s.a)(h,2),C=b[0],y=b[1],k=r.a.useState(!1),S=Object(s.a)(k,2),E=S[0],A=S[1],L=r.a.useState(!1),D=Object(s.a)(L,2),P=D[0],T=D[1],U=r.a.useState([]),I=Object(s.a)(U,2),w=I[0],z=I[1],q=r.a.useState(!0),J=Object(s.a)(q,2),F=J[0],H=J[1],M=r.a.useState({avatar:"./static/media/avatar-loader.7741db8b.gif",name:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430",about:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}),R=Object(s.a)(M,2),B=R[0],V=R[1];function G(){n(!1),_(!1),y(!1),A(!1),T(!1)}return r.a.useEffect((function(){N.getUserInfo().then((function(e){return V(e)})).catch((function(e){return console.log("#####Error: user data; ",e)}))}),[]),r.a.useEffect((function(){N.getAllCards().then((function(e){z(e),H(!1)})).catch((function(e){return console.log("Cards data error: ",e)}))}),[]),Object(u.jsxs)(d.Provider,{value:B,children:[Object(u.jsxs)("div",{className:"page",children:[Object(u.jsx)(p,{}),Object(u.jsx)(j,{cards:w,loadingSpinner:F,onEditProfile:function(){n(!a)},onAddPlace:function(){_(!l)},onEditAvatar:function(){y(!C)},onCardClick:function(e){T(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===B._id}));N.handleCardLikeStatus(e._id,!t).then((function(t){z((function(a){return a.map((function(a){return a._id===e._id?t:a}))}))})).catch((function(e){return console.log("#### Handle Like Error ####",e)}))},onDeleteCardClick:function(e){A(e)},setIsDeleteCardPopupOpened:A}),Object(u.jsx)(m,{})]}),Object(u.jsx)(x,{card:P,onClose:G}),Object(u.jsx)(f,{isOpen:a,onClose:G,onUpdateUser:function(e){N.editUserInfo(e).then((function(e){V(e),G()})).catch((function(e){return console.log("#### Edit user failed ####",e)}))}}),Object(u.jsx)(O,{isOpen:C,onClose:G,onUpdateAvatar:function(e){N.changeAvatar(e).then((function(e){V(e),G()})).catch((function(e){return console.log("#### Avatar update falied ####",e)}))}}),Object(u.jsx)(g,{isOpen:l,onClose:G,onAddPlace:function(e){N.addNewCard(e).then((function(e){z([e].concat(Object(i.a)(w))),G()})).catch((function(e){return console.log("#### Add card failed ####",e)}))}}),Object(u.jsx)(v,{isOpen:E,onClose:G,onDeleteCard:function(){var e;e=E,N.deleteCard(e._id).then((function(){z((function(t){return t.filter((function(t){return t._id===e._id?null:t}))})),G()})).catch((function(e){return console.log("#### Delete card error ####",e)}))}})]})},S=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,17)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),o(e),c(e)}))};c.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(k,{})}),document.querySelector("#root")),S()},6:function(e,t,a){}},[[16,1,2]]]);
//# sourceMappingURL=main.a540b5b6.chunk.js.map